<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_triggerToFinal</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/*if(global.story[32])
{
    visible = false;
    x = -32;
    y = -32;
    p = instance_create(480,320,movingPlatform);
    p.visible = false;
    alarm[11] = 1;
}
if(global.story[33])
{
    with(p)
    {
        instance_destroy();
    }
    instance_destroy();
}*/

new_alarm_timer = 0;
quake = 0;
blendAlpha = 0;
blendColor = 0;
alpha = 0;
storyEnd = 0;
p = 0
open = 0;
triggered = 0;
up = 0;
save1 = 0;
save2 = 0;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="11">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>global.story[33] = true;
player.frozen = true;
with(obj_16FControlledNPC1)
{
    image_blend = c_black;
    image_alpha = 1;
}
open = true;
for(var i=0;i&lt;4;i+=1)
{
    if(!global.gemPlaced[i])
    {
        open = false;
    }
}

if(open)
{
    blendColor = 0;
    global.story[34] = true;
    obj_ultimateEnergyContainer_red.alarm[1] = 25;
    obj_ultimateEnergyContainer_green.alarm[1] = 50;
    obj_ultimateEnergyContainer_blue.alarm[1] = 75;
    obj_ultimateEnergyContainer_yellow.alarm[1] = 100;
    alarm[6] = 175;
    alarm[7] = 175;
    message_add("Gay Bro, Fairy, Thief : Errrrrrrrrrr....");
}
else
{
    message_add("Gay Bro, Fairy, Thief : Errrrrrrrrrr....");
    message_add("Kid : Damn it. They are controlled...I failed to save them! FUCK!!!");
    obj_16FControlledNPC1.alarm[1] = 25;
    obj_16FControlledNPC2.alarm[1] = 50;
    obj_16FControlledNPC3.alarm[1] = 75;
    obj_16FControlledNPC4.alarm[1] = 100;
    alarm[10] = 125;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="10">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if(p)
{
    with(p)
    {
        instance_destroy();
    }
}
save1 = instance_create(448,384,savePoint);
save1.image_alpha = 0;
save2 = instance_create(512,384,savePoint);
save2.image_alpha = 0;
up = instance_create(480,224,obj_upStairs2);
up.image_alpha = 0;
up.warpX = 464 + 17;
up.warpY = 192 + 23;
up.roomTo = r17F;
alpha = 0;
storyEnd = true;
player.frozen= false;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="9">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if(alpha &gt; 0)
{
    alpha -= 0.05;
    alarm[9] = 1;
    with(obj_16FControlledNPC1)
    {
        image_alpha -= 0.05;
    }
}
else
{
    with(obj_16FControlledNPC1)
    {
        instance_destroy();
    }
    alarm[10] = 1;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="8">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>message_add("Gay Bro : Eh.. Seems we were manipulated. Sorry for the trouble caused. ")
message_add("Kid : I see.. You guys almost killed me.");
message_add("Fairy : Thanks for saving us again.");
message_add("Kid : It's also cool that you are back again.");
message_add("Thief : Actually, we detected secret of this tower. We need to open up the road to the hub of the tower and destroy the evil source there. Or the monsters will resurrect someday even you defeated them now.");
message_add("Kid : That sounds serious.");
message_add("Gay Bro : Yes. That's why the tower lead tried to stop us anyway.");
message_add("Fairy : Please help us defeat the tower lead. And we will sure open tbe road to the hub for you.");
message_add("Kid : Got it. Time's ticking, let's moving!");
alpha = 1;
alarm[9] = 10;

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="7">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if(blendAlpha &lt; 255)
{
    blendAlpha += 3;
    if(blendAlpha &gt;= 255)
    {
        blendAlpha = 255;
    }
    blendColor = make_color_rgb(blendAlpha,blendAlpha,blendAlpha);
    with(obj_16FControlledNPC1)
    {
        image_blend = other.blendColor;
    }
    alarm[7] = 1;
}
else
{
    alarm[8] = 10;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="6">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>with(obj_ultimateEnergyLaser)
{
    isEnd = true;
    alarm[1] = 1;
}
audio_playsound(sndHeal);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>global.inCombat = true;
global.combatIndex = 1000;
global.attackDamage = global.attack - 130;
global.defenseDamage = 250 - global.defense;

global.combatHp = global.hp;
global.roomX = player.x;
global.roomY = player.y;
global.mAtk = 250;
global.mDef = 130;
global.mEx = 0;
global.stageRoom = room;

if(global.special[6])
{
    global.Blockable = true;
}
else
{
    global.Blockable = false;
}

if(global.MagicCloak)
{
    global.MagicHP = global.TotalKills;
}

player.frozen = false;

sound_play(sndgras);
//transition_kind = 21;
//transition_kind = 104;
//transition_steps = 80;
room_goto(rNPCBattle);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>message_add("Kid : ...");
message_add("Gay Bro, Fairy, Thief : Die!");
obj_16FControlledNPC1.targetX = 464;
obj_16FControlledNPC1.targetY = 288;
obj_16FControlledNPC2.targetX = 496;
obj_16FControlledNPC2.targetY = 288;
obj_16FControlledNPC3.targetX = 480;
obj_16FControlledNPC3.targetY = 272;
obj_16FControlledNPC4.targetX = 480;
obj_16FControlledNPC4.targetY = 304;
alarm[5] = 5;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="3">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if(blendAlpha &gt; 0)
{
    blendAlpha -= 3;
    if(blendAlpha &lt;= 0)
    {
        blendAlpha = 0;
    }
    blendColor = make_color_rgb(blendAlpha,blendAlpha,blendAlpha);
    with(obj_16FControlledNPC1)
    {
        image_blend = other.blendColor;
    }
    alarm[3] = 1;
}
else
{
    alarm[4] = 10;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>message_add("Kid : You guys.. What's up with you?");
blendAlpha = 255;
alarm[3] = 10;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>with(obj_16FControlledNPC1)
{
    alarm[11] = 1;
}
alarm[2] = 60;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>global.story[32] = true;
sound_loop(sndQuake);
quake = true;
message_add("??? : Ahhhhh!");
alarm[1] = 10;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// ADDED

if new_alarm_timer == 1
{
    if(global.story[32])
    {
        visible = false;
        x = -32;
        y = -32;
        p = instance_create(480,320,movingPlatform);
        p.visible = false;
        alarm[11] = 1;
    }
    if(global.story[33])
    {
        with(p)
        {
            instance_destroy();
        }
        instance_destroy();
    }
}
new_alarm_timer++;
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if(triggered)
{
    if(image_alpha &gt; 0)
    {
        image_alpha -= 0.02;
        image_angle += 10;
        image_xscale += 0.05;
        image_yscale += 0.05;
    }
}
if(quake)
{
    view_xview[0] = random_range(-3,3);
    view_yview[0] = random_range(-3,3);
}
if(storyEnd)
{
    if(alpha &lt; 1)
    {
        alpha += 0.02;
        save1.image_alpha = alpha;
        save2.image_alpha = alpha;
        up.image_alpha = alpha;
    }
    else
    {
        instance_destroy();
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="player">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if(global.story[32])
{
    exit;
}
if(!triggered)
{
    triggered = true;
    player.frozen = true;
    p = instance_create(480,320,movingPlatform);
    p.visible = false;
    sound_play(sndExpMax);
    //FMODInstanceStop(global.currentBGM);
    FMODInstanceStop(global.curMusic);
    alarm[0] = 50;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
